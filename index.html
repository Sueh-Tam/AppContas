<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>App Contas</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- App CSS -->
    <link href="./public/css/styles.css" rel="stylesheet">
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand" href="#">App Contas</a>
      </div>
    </nav>

    <main class="container my-4">
      <div class="row g-4">
        <section class="col-12 col-lg-6">
          <div class="card shadow-sm">
            <div class="card-header">Cadastro de Conta</div>
            <div class="card-body">
              <!-- Formulário de cadastro -->
              <form id="contaForm" class="needs-validation" novalidate>
                <div class="mb-3">
                  <label for="data" class="form-label">Data</label>
                  <input type="date" class="form-control" id="data" name="data" required>
                  <div class="invalid-feedback">Informe a data.</div>
                </div>
                <div class="mb-3">
                  <label for="descricao" class="form-label">Descrição</label>
                  <textarea class="form-control" id="descricao" name="descricao" rows="3" required></textarea>
                  <div class="invalid-feedback">Descrição é obrigatória.</div>
                </div>
                <div class="mb-3">
                  <label for="local" class="form-label">Local</label>
                  <input type="text" class="form-control" id="local" name="local" required>
                  <div class="invalid-feedback">Informe o local.</div>
                </div>
                <div class="mb-3">
                  <label for="categoria" class="form-label">Categoria</label>
                  <select class="form-select" id="categoria" name="categoria" required>
                    <option value="" selected>Selecione...</option>
                    <!-- Opções de categorias serão carregadas dinamicamente -->
                    <option value="Outros">Outros</option>
                  </select>
                  <div class="invalid-feedback">Selecione uma categoria.</div>
                </div>
                <div class="mb-3 d-none" id="categoriaOutrosWrapper">
                  <label for="categoriaOutros" class="form-label">Informe a categoria</label>
                  <input type="text" class="form-control" id="categoriaOutros" name="categoriaOutros" placeholder="Ex.: Presentes, Taxas, etc.">
                  <div class="invalid-feedback">Informe a categoria personalizada.</div>
                </div>
                <div class="mb-3">
                  <label for="valor" class="form-label">Valor (R$)</label>
                  <input type="number" class="form-control" id="valor" name="valor" step="0.01" min="0" inputmode="decimal" required>
                  <div class="invalid-feedback">Informe um valor válido.</div>
                </div>
                <div class="mb-3">
                  <label for="quemPagou" class="form-label">Quem pagou</label>
                  <select class="form-select" id="quemPagou" name="quemPagou" required>
                    <option value="" selected>Selecione...</option>
                    <option value="Matheus">Matheus</option>
                    <option value="Ana">Ana</option>
                  </select>
                  <div class="invalid-feedback">Selecione quem pagou.</div>
                </div>
                <div class="mb-3">
                  <label for="metodoPagamento" class="form-label">Método de pagamento</label>
                  <select class="form-select" id="metodoPagamento" name="metodoPagamento" required>
                    <option value="" selected>Selecione...</option>
                    <option value="Pix">Pix</option>
                    <option value="Crédito">Crédito</option>
                    <option value="Débito">Débito</option>
                    <option value="Dinheiro">Dinheiro</option>
                  </select>
                  <div class="invalid-feedback">Selecione o método de pagamento.</div>
                </div>
                <div class="d-grid">
                  <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
              </form>

              <!-- Feedback visual -->
              <div id="feedback" class="mt-3"></div>
            </div>
          </div>
        </section>

        <section class="col-12 col-lg-6">
          <div class="card shadow-sm">
            <div class="card-header">Ações</div>
            <div class="card-body">
              <div class="row g-2 align-items-center">
                <div class="col-12 col-md-6">
                  <label class="form-label" for="importJson">Importar JSON</label>
                  <input type="file" id="importJson" class="form-control" accept="application/json">
                </div>
                <div class="col-12 col-md-6 d-grid">
                  <button id="exportJson" class="btn btn-outline-secondary">Exportar Contas</button>
                </div>
                <div class="col-12 col-md-6 d-grid">
                  <button id="exportCategorias" class="btn btn-outline-secondary">Exportar Categorias</button>
                </div>
                <div class="col-12 col-md-6 d-grid">
                  <button id="exportPdf" class="btn btn-outline-secondary">Exportar PDF</button>
                </div>
                <div class="col-12 d-grid mt-2">
                  <button id="syncFile" class="btn btn-outline-primary">Sincronizar com arquivo (opcional)</button>
                  <small class="text-muted">Usa File System Access API (Chrome/Edge), requer escolha do arquivo.</small>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>

      <section class="mt-4">
        <div class="card shadow-sm">
          <div class="card-header">Filtros</div>
          <div class="card-body">
            <div class="row g-3">
              <div class="col-6 col-md-3">
                <label for="filtroDataDe" class="form-label">Data de</label>
                <input type="date" id="filtroDataDe" class="form-control">
              </div>
              <div class="col-6 col-md-3">
                <label for="filtroDataAte" class="form-label">Data até</label>
                <input type="date" id="filtroDataAte" class="form-control">
              </div>
              <div class="col-6 col-md-3">
                <label for="filtroValorMin" class="form-label">Valor mínimo</label>
                <input type="number" id="filtroValorMin" class="form-control" step="0.01" min="0">
              </div>
              <div class="col-6 col-md-3">
                <label for="filtroValorMax" class="form-label">Valor máximo</label>
                <input type="number" id="filtroValorMax" class="form-control" step="0.01" min="0">
              </div>
              <div class="col-6 col-md-3">
                <label for="filtroQuemPagou" class="form-label">Quem pagou</label>
                <select id="filtroQuemPagou" class="form-select">
                  <option value="">Todos</option>
                  <option value="Matheus">Matheus</option>
                  <option value="Ana">Ana</option>
                </select>
              </div>
              <div class="col-6 col-md-3">
                <label for="filtroMetodoPagamento" class="form-label">Método</label>
                <select id="filtroMetodoPagamento" class="form-select">
                  <option value="">Todos</option>
                  <option value="Pix">Pix</option>
                  <option value="Crédito">Crédito</option>
                  <option value="Débito">Débito</option>
                  <option value="Dinheiro">Dinheiro</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="mt-4">
        <div class="card shadow-sm">
          <div class="card-header d-flex justify-content-between align-items-center">
            <span>Contas Cadastradas</span>
            <span id="totalizador" class="badge bg-secondary">Total: R$ 0,00</span>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-striped table-sm" id="contasTable">
                <thead>
                  <tr>
                    <th>Data</th>
                    <th>Descrição</th>
                    <th class="d-none d-md-table-cell">Local</th>
                    <th>Categoria</th>
                    <th class="d-none d-lg-table-cell">Quem pagou</th>
                    <th class="d-none d-lg-table-cell">Método</th>
                    <th class="text-end">Valor (R$)</th>
                    <th class="text-end">Ações</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- linhas inseridas via JS -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="container my-4 text-center text-muted">
      <small>Feito com HTML, JavaScript e Bootstrap 5.</small>
    </footer>

    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
    <!-- jsPDF e AutoTable (para geração de PDF) -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.1/dist/jspdf.plugin.autotable.min.js" defer></script>
    <!-- App Scripts (modular) -->
    <script type="module" src="./public/js/app.js"></script>
  </body>
  </html>